---
layout: post
title: vfsStream and file system
tags: [vfsstream, phpunit]
published: true
date: 2012-11-24 20:42
---
Paul M Jones wrote earlier [When Possible, Use File \*Resources\* Instead Of File \*Names\*](http://paul-m-jones.com/archives/2487) and in comments [Chris Hartjes](http://www.littlehart.net/atthekeyboard) was mentioning about [vfsStream](http://vfs.bovigo.org/). So for [@auraphp](https://github.com/auraphp) we thought of making to support vfsStream. What the hell it is? vfsStream is a PHP stream wrapper for a virtual file system that may be helpful in unit tests to mock the real file system. It can be used with any unit test framework, like PHPUnit or SimpleTest. So without touching the file system and not bothering too much about the operating system, file permissions, disk quota, removing the files created by tests on tear down etc we can make use of vfsstream. Lets start Go and get it via composer. {syntaxhighlighter class="php"} { "require": { "mikey179/vfsStream": "1.1.0" } } {/syntaxhighlighter} Run your composer.phar update. {syntaxhighlighter class="php"} require 'vendor/autoload.php'; use org\\bovigo\\vfs\\vfsStream; use org\\bovigo\\vfs\\visitor\\vfsStreamStructureVisitor; use org\\bovigo\\vfs\\visitor\\vfsStreamPrintVisitor; $structure = array( 'Core' =\> array( 'AbstractFactory' =\> array( 'test.php' =\> 'some text content', 'other.php' =\> 'Some more text content', 'Invalid.csv' =\> 'Something else', ), 'AnEmptyFolder' =\> array(), 'badlocation.php' =\> 'some bad content', ) ); $root = vfsStream::setup("root", '', $structure); {/syntaxhighlighter} So now we have created a complex structured file system. How can we check whether the structure is same? {syntaxhighlighter class="php"} vfsStream::inspect(new vfsStreamPrintVisitor()); {/syntaxhighlighter} Now you have the structure how can you get the contents of the file you have created? {syntaxhighlighter class="php"} file\_get\_contents(vfsStream::url('root/Core/badlocation.php')); {/syntaxhighlighter} Or you can do via {syntaxhighlighter class="php"} $root-\>getChild('Core/badlocation.php')-\>getContent(); {/syntaxhighlighter} The question was raised by myself at https://github.com/mikey179/vfsStream/issues/48 . You can create directory and use vfsStreamPrintVisitor to see how the structure will be {syntaxhighlighter class="php"} mkdir(vfsStream::url('root/Core/AnEmptyFolder/hello')); vfsStream::inspect(new vfsStreamPrintVisitor()); {/syntaxhighlighter} There is more documentation how you can use in phpunit or have a look into the recent commits on [Aura.View](https://github.com/auraphp/Aura.View/commit/f39e3452116072a3fe7f529584acb862a76fe15e) For more documentation have a look into https://github.com/mikey179/vfsStream/wiki  
